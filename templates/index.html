<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Netunna REDE Splitter v5.3</title>
  <style>
    body {
      font-family: "Inter","Roboto",Arial,sans-serif;
      background:#f6f7fb; color:#333; margin:0;
      animation: fadeInBody 0.5s ease-in;
    }
    @keyframes fadeInBody { from { opacity:0; transform:translateY(-10px); } to { opacity:1; transform:translateY(0); } }

    header {
      background:#ff6d00; color:#fff; padding:18px 28px;
      box-shadow:0 2px 6px rgba(0,0,0,.15);
      display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px;
    }
    header h1 { margin:0; font-size:24px; letter-spacing:.3px; }
    header small { display:block; font-size:14px; opacity:.9; margin-top:2px; }

    .status-indicador {
      display:flex; align-items:center; gap:8px;
      background:rgba(255,255,255,.15); padding:6px 12px;
      border-radius:20px; font-size:14px; font-weight:500; white-space:nowrap;
      box-shadow:inset 0 0 3px rgba(0,0,0,0.1);
    }
    .status-indicador span { width:10px; height:10px; border-radius:50%; display:inline-block; animation:none; }
    .ativo span { background:#00d24b; animation:pulseGreen 1.5s infinite; }
    .parado span { background:#ff4444; animation:pulseRed 1.5s infinite; }

    @keyframes pulseGreen {
      0% { box-shadow:0 0 0 0 rgba(0,210,75,0.5); }
      70% { box-shadow:0 0 0 6px rgba(0,210,75,0); }
      100% { box-shadow:0 0 0 0 rgba(0,210,75,0); }
    }
    @keyframes pulseRed {
      0% { box-shadow:0 0 0 0 rgba(255,68,68,0.5); }
      70% { box-shadow:0 0 0 6px rgba(255,68,68,0); }
      100% { box-shadow:0 0 0 0 rgba(255,68,68,0); }
    }

    main {
      display:grid; grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
      gap:20px; padding:25px;
    }
    section {
      background:#fff; border-radius:10px; padding:20px;
      box-shadow:0 3px 6px rgba(0,0,0,.08);
      display:flex; flex-direction:column;
      min-width:0; overflow:hidden;
    }
    h2 { color:#ff6d00; font-size:18px; margin:0 0 10px; border-bottom:2px solid #ff6d00; padding-bottom:6px; }

    button {
      background:#ff6d00; color:#fff; border:none; border-radius:6px;
      padding:7px 12px; font-size:14px; cursor:pointer; margin-right:6px;
      transition:background .2s ease, transform .1s ease;
    }
    button:hover { background:#e55f00; transform:scale(1.02); }

    table { width:100%; border-collapse:collapse; }
    th, td { padding:8px 10px; border:1px solid #e0e0e0; text-align:left; font-size:14px; }
    th {
      background:#ff9100; color:#fff;
      position: sticky; top: 0; z-index: 2;
      box-shadow:0 2px 2px rgba(0,0,0,0.05);
    }
    tr:nth-child(even) { background:#fafafa; }
    .ok { color:green; font-weight:bold; }
    .erro { color:#c00; font-weight:bold; }
    .mono { font-family: ui-monospace, Consolas, "Courier New", monospace; }

    footer {
      text-align:center; font-size:13px; color:#777; padding:15px 10px 25px;
      background:#fff; border-top:1px solid #eee; position:relative;
    }
    #clock { font-weight:500; color:#444; font-size:13px; margin-top:6px; }

    .scroll-box {
      border:1px solid #eee; border-radius:6px; overflow:auto;
      max-height:260px; margin-top:10px;
    }
    .scroll-box::-webkit-scrollbar,
    .lote-content::-webkit-scrollbar { height:8px; width:8px; }
    .scroll-box::-webkit-scrollbar-thumb,
    .lote-content::-webkit-scrollbar-thumb { background:#ccc; border-radius:4px; }
    .scroll-box:hover::-webkit-scrollbar-thumb,
    .lote-content:hover::-webkit-scrollbar-thumb { background:#999; }

    .table-count { font-size:13px; color:#555; margin-top:6px; text-align:right; font-style:italic; }

    .lote-grupo {
      background:#fdfdfd; border-radius:8px; margin-top:15px;
      box-shadow:0 1px 4px rgba(0,0,0,.08);
      overflow:hidden; transition:background .3s ease;
    }
    .lote-grupo.open { background:#fff9f3; }
    .lote-header {
      background:#fff5ef; padding:8px 12px;
      display:flex; justify-content:space-between; align-items:center;
      cursor:pointer; border-bottom:1px solid #ffe0c2;
    }
    .lote-header h3 {
      color:#ff6d00; font-size:14px; margin:0; font-weight:600;
      overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
      display:flex; align-items:center; gap:6px;
    }
    .badge { background:#ff9100; color:#fff; font-size:11px; padding:2px 6px; border-radius:10px; }
    .toggle-btn { background:none; border:none; font-size:20px; color:#ff6d00; cursor:pointer; font-weight:bold; transition:transform .2s ease; }
    .toggle-btn:hover { transform:scale(1.2); }
    .lote-content { display:block; overflow:hidden; max-height:0; opacity:0; transition:max-height .4s ease, opacity .4s ease; padding:0 10px; }
    .lote-content.open { opacity:1; max-height:260px; overflow:auto; padding-bottom:10px; }
    .resumo-output { font-weight:bold; color:#444; margin:10px 0 15px; }

    .versao {
      position:absolute; right:12px; bottom:8px;
      font-size:11px; color:#aaa; opacity:.6; font-style:italic;
    }

    /* Ednna iframe */
    #ednna-frame {
      position: fixed;
      bottom: 0;
      right: 0;
      width: 360px;
      height: 520px;
      border: none;
      background: transparent;
      z-index: 9999;
      pointer-events: none;
    }
    #ednna-frame:hover { pointer-events: auto; }
  </style>
</head>

<body>
  <header>
    <div>
      <h1>üß© Netunna REDE Splitter v5.3</h1>
      <small>Processamento Autom√°tico, Valida√ß√£o e Logs</small>
    </div>
    <div id="statusBar" class="status-indicador desconhecido"><span></span><b>Verificando...</b></div>
  </header>

  <main>
    <section>
      <h2>üìÇ Arquivos Enviados</h2>
      <div><button onclick="loadFiles()">üîÑ Atualizar Lista</button></div>
      <div class="scroll-box">
        <table id="inputTable"><thead><tr><th>Arquivo</th><th>Data/Hora de Envio</th></tr></thead><tbody></tbody></table>
      </div>
      <div id="inputCount" class="table-count"></div>
    </section>

    <section>
      <h2>üì¶ Arquivos Gerados</h2>
      <div class="resumo-output" id="outputSummary">üìä Nenhum lote processado ainda.</div>
      <div><button onclick="loadFiles()">üîÑ Atualizar</button><button onclick="downloadAll()">‚¨áÔ∏è Baixar ZIPs por NSA</button></div>
      <div id="outputContainer"></div>
    </section>

    <section>
      <h2>üßæ Hist√≥rico de Processamentos</h2>
      <div class="scroll-box">
        <table id="logTable">
          <thead><tr><th>Data/Hora</th><th>Arquivo</th><th>Tipo</th><th>Total Trailer</th><th>Total Processado</th><th>Status</th><th>Detalhe</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div id="logCount" class="table-count"></div>
    </section>
  </main>

  <footer>
    ¬© Netunna Automations ‚Äî REDE Splitter v5.3 | Atualiza√ß√£o autom√°tica a cada 30s
    <div id="clock">üïí <span id="currentTime"></span> ‚Ä¢ Hor√°rio de Bras√≠lia (BRT)</div>
    <span class="versao">Build Stable</span>
  </footer>

  <!-- Ednna via iframe -->
  <iframe id="ednna-frame" src="/static/ednna.html" title="Assistente Ednna"></iframe>

  <script src="/static/main.js"></script>
</body>
</html>
